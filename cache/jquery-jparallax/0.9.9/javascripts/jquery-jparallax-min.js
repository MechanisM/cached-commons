(function(i){function g(k){var j=k.replace(".html","");return j.replace("#","")}function h(j){if(j.xorigin=="left"){j.xorigin=0}else{if(j.xorigin=="middle"||j.xorigin=="centre"||j.xorigin=="center"){j.xorigin=0.5}else{if(j.xorigin=="right"){j.xorigin=1}}}if(j.yorigin=="top"){j.yorigin=0}else{if(j.yorigin=="middle"||j.yorigin=="centre"||j.yorigin=="center"){j.yorigin=0.5}else{if(j.yorigin=="bottom"){j.yorigin=1}}}}function e(k,j,l){var m={x:0,y:0,sum:0};if(!k.ontarget){m.x=l.x-j.x;m.y=l.y-j.y;m.sum=Math.sqrt(m.x*m.x+m.y*m.y);l.x=j.x+m.x*k.takeoverFactor;l.y=j.y+m.y*k.takeoverFactor;if(m.sum<k.takeoverThresh&&m.sum>k.takeoverThresh*-1){k.ontarget=true}}else{l.x=j.x;l.y=j.y}}function d(j,k){var l=k.element.offset();i.extend(j,{width:j.element.width(),height:j.element.height()});i.extend(k,{width:k.element.width(),height:k.element.height(),top:l.top,left:l.left})}function c(n,k,l){var m;var j;if(typeof(n)==="string"){if(n.search(/^\d+\s?px$/)!=-1){n=n.replace("px","");n=parseInt(n,10);m=k*(l-n);j=k*100+"%";return{travel:n,travelpx:true,offset:m,cssPos:j}}else{if(n.search(/^\d+\s?%$/)!=-1){n.replace("%","");n=parseInt(n,10)/100}else{n=1}}}m=k*(1-n);return{travel:n,travelpx:false,offset:m}}function b(k,j,o){var n;var l;var m={};k[j]=i.extend({},{width:k[j].element.width(),height:k[j].element.height()},k[j]);n=c(k[j].xtravel,k[j].xorigin,k[j].width);l=c(k[j].ytravel,k[j].yorigin,k[j].height);i.extend(k[j],{diffxrat:o.width/(k[j].width-o.width),diffyrat:o.height/(k[j].height-o.height),xtravel:n.travel,ytravel:l.travel,xtravelpx:n.travelpx,ytravelpx:l.travelpx,xoffset:n.offset,yoffset:l.offset});if(n.travelpx){m.left=n.cssPos}if(l.travelpx){m.top=l.cssPos}if(n.travelpx||l.travelpx){k[j].element.css(m)}}function f(m,l,j){var k;i.extend(m[l],{content:[]});for(var o=0;o<m[l].element.children().length;o++){if(!m[l].content[o]){m[l].content[o]={}}if(!m[l].content[o].element){m[l].content[o]["element"]=m[l].element.children().eq(o)}if(!m[l].content[o].anchor&&m[l].content[o].element.children("a").attr("name")){m[l].content[o]["anchor"]=m[l].content[o].element.children("a").attr("name")}if(m[l].content[o].anchor){k=m[l].content[o].element.offset();i.extend(m[l].content[o],{width:m[l].content[o].element.width(),height:m[l].content[o].element.height(),x:k.left-j.left,y:k.top-j.top});i.extend(m[l].content[o],{posxrat:(m[l].content[o].x+m[l].content[o].width/2)/m[l].width,posyrat:(m[l].content[o].y+m[l].content[o].height/2)/m[l].height})}}}function a(l,o,n){var j;var p;var m;for(var k=0;k<l.length;k++){j=l[k].xtravel*o+l[k].xoffset;p=l[k].ytravel*n+l[k].yoffset;m={};if(l[k].xparallax){if(l[k].xtravelpx){m.marginLeft=j*-1+"px"}else{m.left=j*100+"%";m.marginLeft=j*l[k].width*-1+"px"}}if(l[k].yparallax){if(l[k].ytravelpx){m.marginTop=p*-1+"px"}else{m.top=p*100+"%";m.marginTop=p*l[k].height*-1+"px"}}l[k].element.css(m)}}i.fn.jparallax=function(l){var m=i().extend({},i.fn.jparallax.settings,l);var n={xparallax:m.xparallax,yparallax:m.yparallax,xorigin:m.xorigin,yorigin:m.yorigin,xtravel:m.xtravel,ytravel:m.ytravel};var j={element:m.mouseport,takeoverFactor:m.takeoverFactor,takeoverThresh:m.takeoverThresh};if(m.mouseport){j.element=m.mouseport}var o=[];for(var k=1;k<arguments.length;k++){o.push(i.extend({},n,arguments[k]))}return this.each(function(){var r={x:0.5,y:0.5};var v={x:0.5,y:0.5};var w={running:false,frame:m.frameDuration,fire:function(z,A){e(u,r,v);a(t,v.x,v.y);this.running=setTimeout(function(){if(r.x!=z||r.y!=A||!u.ontarget){w.fire(r.x,r.y)}else{if(w.running){w.running=false}}},w.frame)}};var p={element:i(this)};var u=i.extend({},{element:p.element},j,{xinside:false,yinside:false,active:false,ontarget:false});var t=[];function q(y,z,C){for(var x=0;x<y.length;x++){var A=false;for(var B=0;B<y[x].content.length;B++){if(y[x].content[B].anchor==z){C(x,B);return[x,B]}}}return false}d(p,u);for(var s=0;s<p.element.children().length;s++){t[s]=i.extend({},n,o[s],{element:p.element.children("*:eq("+s+")")});b(t,s,u);if(m.triggerResponse){f(t,s,p.element.offset())}}p.element.children().css("position","absolute");a(t,0.5,0.5);if(m.mouseResponse){i().mousemove(function(x){u.xinside=(x.pageX>=u.left&&x.pageX<u.width+u.left)?true:false;u.yinside=(x.pageY>=u.top&&x.pageY<u.height+u.top)?true:false;if(u.xinside&&u.yinside&&!u.active){u.ontarget=false;u.active=true}if(u.active){if(u.xinside){r.x=(x.pageX-u.left)/u.width}else{r.x=(x.pageX<u.left)?0:1}if(u.yinside){r.y=(x.pageY-u.top)/u.height}else{r.y=(x.pageY<u.top)?0:1}}if(u.xinside&&u.yinside){if(!w.running){w.fire(r.x,r.y)}}else{if(u.active){u.active=false}}})}if(m.triggerResponse){p.element.bind("jparallax",function(y,x){x=g(x);q(t,x,function(z,A){r.x=t[z].content[A].posxrat*(t[z].diffxrat+1)-(0.5*t[z].diffxrat);r.y=t[z].content[A].posyrat*(t[z].diffyrat+1)-(0.5*t[z].diffyrat);if(!m.triggerExposesEdges){if(r.x<0){r.x=0}if(r.x>1){r.x=1}if(r.y<0){r.y=0}if(r.y>1){r.y=1}}u.ontarget=false;if(!w.running){w.fire(r.x,r.y)}})})}i(window).resize(function(){d(p,u);for(var x=0;x<t.length;x++){b(t,x,u)}})})};i.fn.jparallax.settings={mouseResponse:true,mouseActiveOutside:false,triggerResponse:true,triggerExposesEdges:false,xparallax:true,yparallax:true,xorigin:0.5,yorigin:0.5,xtravel:1,ytravel:1,takeoverFactor:0.65,takeoverThresh:0.002,frameDuration:25};h(i.fn.jparallax.settings);i(function(){})})(jQuery);
